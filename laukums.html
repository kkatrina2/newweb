<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="css/style.css">
    </head>
    <body>
        <div class="container-fluid bg-1 text-center">
    <form>
        <label for="fname">Ievadi skaitli: </label><br>
        <input value="4" type="number" id="quantity" name="quantity" min="1" max="5">
        <input type = "button" onclick="izveidoLaukumu(quantity.value)" value="Sākt jaunu spēli!"> 
        <label id="minutes">00</label>:<label id="seconds">00</label>
    </form> 
    <script>
    var jauns=[];
    var masivs = [];
    var bilde, teksts,atverti=0; 
        function izveidoLaukumu(n){
            var timeVar =setInterval(setTime, 1000);
            veidoMasivu();
            sajaucMasivu();
            jaunsMasivs(n);
            sajaucJauns();
            let i;
            let k=0;
            let pip=0;
            let ieprieks;
            if(document.getElementById("laukums")!= null){
                document.body.removeChild(document.getElementById("laukums"));
            }
            let p = document.createElement("div");
            p.setAttribute("id","laukums");    
            for (i=0; i<n;i++){
                let y = document.createElement("div");
                for (let m=0; m<n;m++){
                    let x = document.createElement("BUTTON");
                    x.className = 'button';
                    let nr=n*i+m;
                    if(jauns[nr].indexOf(".")>=0){
                        x.setAttribute("id", "bpoga"+(nr));
                        x.setAttribute("style","background-image: url("+jauns[nr]+")"); 
                        x.setAttribute("style", "background-color:#2f2f2f");
                    }else{
                        x.setAttribute("id", "tpoga"+(nr));
                        x.innerHTML=jauns[nr];
                        x.setAttribute("style", "color:#2f2f2f");
                    }
            var cipars;
            x.onclick=()=>{
                console.log(x.id);
                var rr= x.id.substring(5);
                if(x.id.indexOf("b")>=0){
                x.setAttribute("style","background-image: url("+jauns[rr]+")");
                bilde = setTimeout(function(){x.setAttribute("style","background-color:#2f2f2f");},2000);
                }else{
                    x.setAttribute("style", "color:white");
                    x.innerHTML=jauns[rr];
                    teksts = setTimeout(function(){ x.setAttribute("style", "color:#2f2f2f");},2000);
                } 
                    if(pip%2==0){
                        ieprieks=x.id;
                        console.log(ieprieks);
                        let {rinda, kolonna} = matrixIndexed(masivs, jauns[rr]);
                        console.log( rinda, kolonna);
                        cipars = rinda;
                    }else{
                        let {rinda, kolonna} = matrixIndexed(masivs, jauns[rr]);
                        console.log(rinda, kolonna);
                        if(cipars!=rinda){
                            if(x.id.indexOf("b")>=0){
                                setTimeout(function(){ x.setAttribute("style", "background-color:#2f2f2f");}, 1000);
                            }else{
                                x.setAttribute("style", "color:#2f2f2f");
                                setTimeout(function(){ x.innerHTML=jauns[rr];}, 1000);
                            }
                        }else{
                            if(x.id.indexOf("b")>=0){
                                stopText();
                                stopBilde();
                                atverti=atverti+2;
                                console.log("paris");
                                if(atverti==n*n){
                                   clearInterval(timeVar);
                                   myFunction();
                                   setTimeout(function(){ location.reload();},2000);
                                }
                            }else{
                                stopBilde();
                                stopText();
                                atverti=atverti+2;
                                if(atverti==n*n){
                                   clearInterval(timeVar);
                                   myFunction();
                                   setTimeout(function(){ location.reload();},2000);
                                }
                            }
                        }
                    }
                    pip++;
                }    
                y.appendChild(x);
                }
                p.appendChild(y);
                k=k+n;
            } 
            document.body.appendChild(p);
        }
        function myFunction() {
            alert("Juhuu! Tev izdevās!");
        }
    function stopText() {
        clearTimeout(teksts);
    }
    function stopBilde() {
        clearTimeout(bilde);
    }
    var minutesLabel = document.getElementById("minutes");
    var secondsLabel = document.getElementById("seconds");
    var totalSeconds = 0;
    
    
    function setTime() {
       ++totalSeconds;
       secondsLabel.innerHTML = pad(totalSeconds % 60);
       minutesLabel.innerHTML = pad(parseInt(totalSeconds / 60));
    }
    function pad(val) {
        var valString = val + "";
        if (valString.length < 2) {
           return "0" + valString;
        }else{
    return valString;
  }
}
    function matrixIndexed(masivs, name) {
            var rinda;
            var kolonna;
            for (rinda = 0; rinda < masivs.length; ++rinda) { 
                const nsDetails = masivs[rinda];
                for (kolonna = 0; kolonna < nsDetails.length; ++kolonna) {
                    const tempObject = nsDetails[kolonna];
                    if (tempObject === name) {  
                        return { rinda, kolonna};
                    }
                }
            }
            return {};
        }
    var bildes = ['img/0.jpg','img/1.jpg','img/2.jpg','img/3.jpg','img/4.jpg','img/5.jpg','img/6.jpg','img/7.jpg','img/8.jpg',
                'img/9.jpg','img/10.jpg','img/11.jpg','img/12.jpg','img/13.jpg','img/14.jpg','img/15.jpg','img/16.jpg',
                'img/17.jpg','img/18.jpg','img/19.jpg','img/20.jpg','img/21.jpg','img/22.jpg','img/23.jpg','img/24.jpg',
                'img/25.jpg','img/26.jpg','img/27.jpg','img/28.jpg','img/29.jpg','img/30.jpg','img/31.jpg','img/32.jpg',
                'img/33.jpg','img/34.jpg','img/35.jpg','img/36.jpg','img/37.jpg','img/38.jpg','img/39.jpg','img/40.jpg',
                'img/41.jpg','img/42.jpg','img/43.jpg','img/44.jpg','img/45.jpg','img/46.jpg','img/47.jpg','img/48.jpg',
                'img/49.jpg'];
        
    var dogs = ["Sprogainais retrīvers","Bīgls", "Vācu aitu suns", "Franču buldogs","Labradors retrīvers",
            "Zeltainais retrīvers","Pūdelis","Sibīrijas Haskijs","Rotveilers","Taksis","Angļu Buldogs",
            "Bernes Ganu suns","Dobermanis","Velsas Korgijs pembroks","Maltas Zīda suns","Šicū","Borderkollijs",
            "Basets","Bostonas terjers","Ņūfaundlietis","Sanbernārs","Čau-čau","Amerikāņu standfordšīras terjers",
            "Bulterjers","Angļu Springerspaniels","Džeka Rasela terjers","Ķīnas Cekulainais suns","Dalmācietis",
            "Šetlijs","Mudijs (Mudi)","Angļu Kokerspaniels","Bladhaunds","Miniatūrais pinčers","Samojeds","Kane korso","Šiba",
            "Angļu pointers","Erdelterjers","Levrete","Argentīnas dogs","Austrālijas Aitu suns","Basenži",
            "Bokseris","Ciaua","Grifons","Hofavarts","Komandors","Latvijas dzinējsuns","Mopsis"];
    
    
function veidoMasivu(){
    for (let i = 0; i < bildes.length; i++) {
        let m1 =[];
        m1.push(bildes[i]);
        m1.push(dogs[i]);
        masivs.push(m1);
    }
    
    
}
function jaunsMasivs(n){
    let p=(n*n)/2;
    let a;
        for(let r=0; r<p; r++){
            for(let s=0;s<2;s++){
                a=masivs[r][s];
                console.log(a);
            jauns.push(a);
            }
        
    }console.log("viss");
}
    
    function sajaucJauns(){
            for(let i=0;i<jauns.length;i++){
                let rand=Math.floor(Math.random()*jauns.length);
                let tmp=jauns[i];
                jauns[i]=jauns[rand];
                jauns[rand]=tmp;
            }
            for(let i=0;i<jauns.length;i++){
                    console.log(jauns[i]);
                }
            //console.log(jauns.length);
    }
    
    var a,a1,b,b1;
    function sajaucMasivu(){
        for(var k=0;k<50;k++){
           var t=Math.floor(Math.random() * 49);
           var p=Math.floor(Math.random() * 49);
           //console.log(t+"--"+p);
           a=masivs[t][0];
           a1=masivs[t][1];
           b=masivs[p][0];
           b1=masivs[p][1];
           masivs[p][0]=a;
           masivs[p][1]=a1;
           masivs[t][0]=b;
           masivs[t][1]=b1;
        }
    }
</script>
    </div>
    </body>
</html>
